<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Block Jumper â€” DSRT Games</title>
  <style>
    html,body{margin:0;padding:0;height:100%;background:#0c0f16;color:#fff;overflow:hidden;font-family:system-ui,Arial}
    canvas{display:block;margin:0 auto;background:linear-gradient(180deg,#1a1d28,#07080b);border:2px solid #222;border-radius:8px}
    #hud{position:fixed;top:10px;left:10px;font-weight:bold;color:#ffb86b}
  </style>
</head>
<body>
  <div id="hud">Score: <span id="score">0</span></div>
  <canvas id="game" width="600" height="400"></canvas>

  <script>
    const c = document.getElementById('game');
    const ctx = c.getContext('2d');
    const scoreEl = document.getElementById('score');
    
    let player = {x:50,y:340,w:30,h:30,vy:0,jump:-9,grounded:true};
    let obstacles = [];
    let particles = [];
    let score = 0;
    let frame = 0;

    // --- Audio ---
    const jumpSound = new Audio('https://cdn.jsdelivr.net/gh/naptha/tiny-sound-examples/jump.wav');
    const hitSound = new Audio('https://cdn.jsdelivr.net/gh/naptha/tiny-sound-examples/hit.wav');
    const scoreSound = new Audio('https://cdn.jsdelivr.net/gh/naptha/tiny-sound-examples/coin.wav');

    // --- Particle System ---
    function spawnParticles(x,y,color){
      for(let i=0;i<8;i++){
        particles.push({x,y,dx:(Math.random()-0.5)*4,dy:(Math.random()-0.5)*4,life:40,color});
      }
    }

    // --- Obstacle spawn ---
    function spawnObstacle(){
      const size = 30 + Math.random()*20;
      obstacles.push({x:600,y:370-size,w:size,h:size});
    }

    function loop(){
      frame++;
      ctx.clearRect(0,0,600,400);

      // ground
      ctx.fillStyle="#222";
      ctx.fillRect(0,370,600,30);

      // spawn obstacle
      if(frame % 90 === 0) spawnObstacle();

      // update player
      player.y += player.vy;
      player.vy += 0.4;
      if(player.y>=340){player.y=340;player.vy=0;player.grounded=true;}

      // move + draw obstacles
      ctx.fillStyle="#ffb86b";
      for(let i=0;i<obstacles.length;i++){
        const o=obstacles[i];
        o.x -= 6;
        ctx.fillRect(o.x,o.y,o.w,o.h);
        if(o.x+o.w<0) obstacles.splice(i,1);
        // collision
        if(o.x<player.x+player.w && o.x+o.w>player.x && o.y<player.y+player.h){
          hitSound.play();
          alert('Game Over! Skor: '+score);
          location.reload();
        }
      }

      // draw particles
      for(let i=particles.length-1;i>=0;i--){
        const p=particles[i];
        p.x+=p.dx; p.y+=p.dy; p.life--;
        ctx.fillStyle=p.color;
        ctx.fillRect(p.x,p.y,3,3);
        if(p.life<=0) particles.splice(i,1);
      }

      // draw player
      ctx.fillStyle="#7afcff";
      ctx.fillRect(player.x,player.y,player.w,player.h);

      // score
      if(frame%30==0){score++;scoreEl.textContent=score;scoreSound.play();}
      
      requestAnimationFrame(loop);
    }

    addEventListener('keydown',e=>{
      if((e.code==='Space'||e.code==='ArrowUp') && player.grounded){
        player.vy = player.jump;
        player.grounded = false;
        jumpSound.play();
        spawnParticles(player.x+player.w/2, player.y+player.h, "#7afcff");
      }
    });

    c.addEventListener('click',()=>{
      if(player.grounded){
        player.vy = player.jump;
        player.grounded=false;
        jumpSound.play();
        spawnParticles(player.x+player.w/2, player.y+player.h, "#7afcff");
      }
    });

    loop();
  </script>
</body>
</html>
